---
title: 区块链与分布式账本的鉴别诊断
author: Old Seed
date: 2020-09-22 16:34:00 +0800
categories: [区块链,区块链原理]
tags: [blockchain]
toc: true

---



不知不觉中，比特币已经诞生了十余年了。十余年来，比特币从默默无闻到风光无限，再到今天的不温不火。可以说是比特币的辉煌带火了区块链。也正式由于比特币太辉煌了，带给人们一个误解，认为比特币就是区块链，区块链就是比特币。其实不然，区块链是一种技术，比特币只是区块链的一个应用。

还有一种常见的误解，认为区块链就是分布式账本。分布式账本技术，指的是一种不需要被任何中心化主体存储或者确认的交易记录方式。简单理解，这是一种分布式的记账技术，也就是一种分布式的记录人与人之间交易的技术。区块链广义上是一种分布式可信存储数据的计算机系统。从对这两种技术的描述性定义可以看出，分布式账本技术也是区块链技术的一种应用。如果用区块链技术来记录交易的行为，那就是分布式账本了。但是分布式账本不一定是基于区块链的，区块链也不一定仅用来记录交易行为的。

无论是比特币还是与比特币类似的其他虚拟货币，可以说都是分布式账本，也都是用区块链实现的分布式账本技术。但是区块链绝不等于是虚拟货币，也不等于是分布式账本。



## 分布式账本的两大技术基石

分布式账本技术，指的是一种不需要被任何中心化主体存储或者确认的交易记录方式。基于区块链的分布式账本技术，或者说常见的虚拟货币技术，有两大技术基石。分别是公私钥签名技术和共识算法。这两个基石分别解决了匿名虚拟货币的两个问题。公私钥签名解决了“抵赖问题”，共识算法解决了“双花问题”。



### 公私钥签名

公私钥签名技术用到了非对称加密算法。非对称加密算法有一对秘钥，一个作为私钥（自己保存），另一个作为公钥（对外公开）。用私钥加密过的内容，可以使用公钥进行解密。为了防止数据被篡改，也防止抵赖，就产生了公私钥签名技术。

公私钥签名的步骤是：A向B发送消息，首先用公开的摘要算法，把要发送的信息生成一段数字摘要。之后，A用自己的私钥对摘要进行加密，生成的加密摘要就叫A对消息的签名。A把该消息和签名发送给B。B收到A发送的消息之后，用相同的摘要算法对消息生成摘要，然后用A的公钥解密A接收到的加密摘要，得到一个明文摘要。如果这个解密出明文摘要和B计算出的消息摘要一致，则说明A发送的消息没有经过篡改。

公私钥签名常用的非对称加密算法包括：RSA，ECC，SM2等。 RSA是基于大质数的非对称加密算法，也是目前使用最广泛的非对称加密算法。ECC是基于椭圆螺旋曲线的非对称加密算法，算法性能要优于RSA算法。SM2是我们国家自己的发明的非对称加密算法，基于ECC，算法性能要优于RSA算法。

公私钥签名的意义在于在签名核验通过的情况下，发送方对信息的内容不能抵赖。因为私钥是发送方自己保存的，公钥是公开的，所以签名是不能伪造的但却是可以核验的。这在分布式账本的应用场景下是很重要的。分布式账本记录的是人们的交易行为，举例来说，可能是老张付给老李1元钱。这笔交易由老张发起，“老张付给老李1元钱”这条信息经过老张的私钥签名之后，所有持有老张公钥的人都可以对这条信息进行核验，核验通过之后，老张是不能够抵赖的。

公私钥签名技术保证了谁说的话就是是谁说的，不能抵赖。这是分布式账本的第一技术基石。



### 共识算法

共识算法是虚拟货币的另一项技术基石。在分布式系统中，共识算法用来解决系统的一致性问题，在区块链实现的分布式账本中，共识算法用来解决双花问题。

所谓双花问题，通俗一点讲，就是一笔钱当做两笔钱来花，也就“双花”。“双花”显然是非法的，而且这种问题在现实中不存在，一张钞票花出去了就是花出去了，不会由机会花第二次。但是在数字世界中，“钞票”是数字的，同一张数字的钞票可以很方便地复制，同时付给两个人。这种情况出现后，系统就需要“共识算法”来决定两笔支付中，哪一笔支付是有效的，哪一笔支付是无效的。所谓“共识”是指让系统中的大多数节点达成共识，大多数节点一致认为哪笔交易有效，哪笔交易无效。共识算法是分布式系统研究的热点，在中心化的系统中不会存在双花问题。

在分布式系统中，多个主机通过异步通信方式组成网络集群。在这样的一个异步系统中，需要主机之间进行状态复制，以保证每个主机达成一致的状态共识。然而，异步系统中，可能出现无法通信的故障主机，而主机的性能可能下降，网络可能拥塞，这些可能导致错误信息在系统内传播。因此需要在默认不可靠的异步网络中定义容错协议，以确保各主机达成安全可靠的状态共识。

所谓共识，简单理解就是指大家都达成一致的意思。其实在现实生活中，有很多需要达成共识的场景，比如开会讨论，双方或多方签订一份合作协议等。而在分布式账本中，每个节点必须要做的事情就是让自己的账本跟其他节点的账本保持一致。在传统的软件结构中，有一个中心服务器存在，几乎不会存在这个问题。在实际生活中，很多事情人们也都是按照这种思路来的，比如企业老板发布一个通知，员工照着做。但是区块链是一个分布式的对等网络结构，在这个结构中没有哪个节点是“老大”，一切都要商量着来。

所以在区块链系统中，如何让每个节点通过一个规则将各自的数据保持一致是一个很核心的问题，这个问题的解决方案就是制定一套共识算法，实现不同账本节点上的账本数据的一致性和正确性。这就需要借鉴已有的在分布式系统中实现状态共识的算法，确定网络中选择记账节点的机制，以及如何保障账本数据在全网中形成正确、一致的共识。

共识算法其实就是一个规则，每个节点都按照这个规则去确认各自的数据。我们暂且抛开算法的原理，先来想一想在生活中我们会如何解决这样一个问题：假设一群人开会，这群人中没有一个领导或者说老大，大家各抒己见，那么最后如何统一出一个决定出来呢？实际处理的时候，我们一般会在某一个时间段中选出一个人，那个人负责汇总大家的内容，然后发布完整的意见，其他人投票表决，每个人都有机会来做汇总发表，最后谁的支持者多就以谁的最终意见为准。这种思路其实就算是一种共识算法了。然而在实际过程中，如果人数不多并且数量是确定的，还好处理；如果人数很多且数量也不固定，那就很难通过这种方式投票决定了，效率太低。我们需要通过一种机制筛选出最有代表性的人，在共识算法中就是筛选出具有代表性的节点。

那如何筛选呢？其实就是设置一组条件，就像筛选尖子生一样，给一组指标让大家来完成，谁能更好地完成指标，谁就能有机会被选上。在区块链系统中，存在着多种这样的筛选方案，比如PBFT（Practical Byzantine Fault Tolerance，实用拜占庭容错算法）、PoW（Proof of Work，工作量证明）、PoS（Proof of Stake，权益证明）、DPoS（Delegate Proof of Stake，委托权益证明）、Ripple（瑞波）等，各种不同的算法，其实就是不同的游戏玩法。

